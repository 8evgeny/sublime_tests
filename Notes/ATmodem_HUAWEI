Прошивка модема   https://4pda.ru/forum/index.php?showtopic=582284&st=20#entry38688416
Для данного модема существуют 2 принципиально разных типа прошивок - STICK и HILINK. Прошивки взаимозаменяемы

STICK
С этой прошивкой устройство ведет себя как классический USB-модем: имеется командный AT-порт, через который можно установить соединение посредством PPP-протокола. Именно так работают практически все 3G-модемы предыдущих поколений. При этом скорость ограничена - не более 20-30 Mbit на прием. Кроме PPP-режима, имеется режим NDIS. При этом модем эмулирует сетевой интерфейс, через который и передаются данные, а через AT-порт идут только управляющие команды. В этом режиме скорость не ограничена. Основная особенность stick-режима - установление соединения и поддержка работы канала производится средствами ОС компьютера, к которому подключен модем. При этом компьютер получает IP-адрес непосредственно у провайдера сотовой связи через запрос DHCP, а модем работает как сетевой мост, передавая пакеты от компьютера в сотовую сеть и обратно, никак их не изменяя.

Начальная USB-композиция stick-модема - это виртуальный CD-ROM и картридер microSD. Для того, чтобы появились модемные порты, надо сделать переключение композиции. Под windows этим занимается операторский софт, имеющийся на виртуальном CD, или фирменная программа от huawei - Mobile Partner. Под linux переключение делает программа usb-modeswitch. Имеется возможность запретить перелючение композиций. Это делается такой командой:
AT^SETPORT="FF;10,12,16"

При этом модем сразу после включения будет выглядеть как 2 AT-порта и сетевая карта NDIS. CD и microSD будут исключены из конфигурации. Такой режим крайне удобен для использования модема в различных домашних роутерах. Вернуть обратно композицию с переключением можно командой:
AT^SETPORT="A1,A2;10,12,16,A1,A2"

Номера версий stick-прошивки всегда начинаются на 21 - например, 21.285.01.02.143. С таким типом прошивки поставляются модемы от МТС и Мегафона.

В комплекте со Stick-прошивкой в модем прошивается так называемый Dashboard - образ виртуального CD, появляющегося в системе после подключения модема. На этом CD находятся драйвера модема под разные ОС, а также управляющая программа, с помощью которой устанавливают соединение с интернетом, читают SMS, делают USSD-запросы и т.д. Существует универсальная версия этой программы от фирмы-производителя модема Huawei (Huawei Modem), а также специализированные версии от конкретных операторов связи.


HILINK
С прошивкой HILINK модем работает в режиме роутера, и представляется компьютеру в виде сетевого интерфейса (usb-ethernet-rndis). Компьютер получает с этого интерфейса сетевые настройки через DHCP, и далее ходит через него в интернет, как через обычную проводную локальную сеть. Всю заботу об установлении соединения и поддержании канала модем берет на себя, компьютер даже не замечает, что доступ в интернет осуществляется через сотовую сеть. В этом режиме модем имеет свой собственный локальный IP-адрес (обычно 192.168.8.1), видимый со стороны компьютера как шлюз по умолчанию (default route), а также внешний IP-адрес, получаемый из сотовой сети. Между сетью сотового провайдера и локальной сетью (модем-компьютер) осуществляется маршрутизация с использованием механизма трансляции адресов (NAT). Предусмотрен проброс портов из внешней сети (port forwarding и DMZ).

Настройка модема в этом режиме производится через WEB-интерфейс, имеющийся в модеме, и доступный через его локальный IP-адрес. Также через WEB-интерфейс доступна информация о состоянии модема и сигнале сотовой сети, управление подключением, прием-передача SMS-сообщений и USSD-команд, SIM-меню и многое другое. Это особенно ценно для пользователей Linux, а также для тех, у кого модем подключен не к компьютеру, а к домашнему роутеру. Настройка модема через AT-команды, как в stick-прошивках, в штатном режиме hilink-прошивок не производится, хотя и возможна в специальном отладочном режиме DebugMode.

Начальная USB-композиция HILINK-модема в точности такая же, как и у stick - виртуальный CD-ROM и картридер microSD. Переключение композиций под windows производится небольшой программой mbbservice, запускаемой со встроенного CD. Под linux это делает программа usb-modeswitch. Штатно разработчиками модема не предусмотрен режим без переключения композиций. Тем не менее, путем некоторой модификации прошивки такой режим сделать возможно. При этом теряется встроенный картридер SD, однако появляется возможность использовать модем с любым роутером, поддерживающим сетевые карты usb-rndis.

Номера версий hilink-прошивки всегда начинаются на 22 - например, 22.286.03.00.00. С таким типом прошивки поставляется модем от Билайна.
Прошивки HILINK состоят из двух частей - сама прошивка, и WebUI (веб-интерфейс). Первой прошивается основная прошивка, потом WebUI.

Участниками данного форума была выполнена доработка стандартной прошивки для расширения функциональности и включения изначально заблокированных функций.

Если при прошивке модем спросит пароль, то его можно рассчитать тем же самым калькулятором (ссылка в заголовке шапки). Он там называется flash-код.

Внутри модема работает операционная система, построенная на базе Android 2.3 с ядром linux 3.4.5. Модифицированные прошивки позволяют получить доступ к консоли Linux-части модема через telnet:
telnet 192.168.8.1

А также через отладочную утилиту Андроида - ADB:
adb connect 192.168.8.1
adb shell



Имя устройства:	E3372H-153
Серийный номер:	G4P7S19A14005035
IMEI:	        352811040457552
IMSI:	        Неизвестно
ICCID:	        Неизвестно
Мой номер:	    Неизвестно
Версия АО:	    CL2E3372HM
Версия ПО:	    22.333.01.00.00
Версия веб-интерфейса:	17.100.20.00.03
MAC-адрес LAN:	BA:AB:BE:34:00:00
IP-адрес WAN:	Неизвестно
IPv6-адрес WAN:	Неизвестно
DNS 1 / DNS 2:	Неизвестно / Неизвестно

ВАЖНО! Каждая из прошивок состоит из 2 компонентов: stick-прошивка и Dashboard, hilink-прошивка и WebUI. Не пытайтесь прошить WebUI на stick-прошивку, а Dashboard - на Hilink-прошивку. Вы можете привести модем в полностью неработоспособное состояние!


ПО:
minicom, usb_modeswitch, NetworkManager(NM), ModemManager

Сначала необходимо перевести модем в режим - модема/сетевой карты, это делает usb_modeswitch. Делает он это единоразово пока модем в гнезде, если вы достанете модем и вставите обратно — режим будет стандартным (cd-rom, sd card, ndis).

Для перевода необходимо сделать следующее:

Узнать код производителя (vendor) и код продукта(product). В терминале вводим lsusb и получаем вывод подключённых usb устройств, если модем был подключен, то он будет в списке устройств. 
Bus 001 Device 088: ID 12d1:14dc Huawei Technologies Co., Ltd. E33372 LTE/UMTS/GSM HiLink Modem/Networkcard
Число 0x12d1 — код производителя(Vendor), 0x14dc — код устройства(product).
Числа находятся в шестнадцатеричной системе счисления(HEX) и 0x перед числом обязательно.

Имея эти коды мы можем пойти двумя путями:
1. захардкодить их(коды) в usb_modeswitch.conf, и при каждом запуске usb_modeswitch они будут браться из конфигурационного файла.
nano /etc/usb_modeswitch.conf
в файл добавим:


DefaultVendor=0x12d1
DefaultProduct = 0x1f01
TargetVendor= 0x12d1
TargetProduct= 0x14dc

DisableSwitching=1

перегружаем - и у нас модем в режиме mass storage



После в /dev должны появиться устройства ttyUSB

2. в терминале ввести usb_modeswitch -v 0x12d1 -p 0x14dc. Так же в /dev должны появиться устройства ttyUSB

после перевода в режим модема можно пользоваться wvdial или pon, или любым другим методом ppp соединения.

Тут поступить надо так:echo "options usbserial vendor=0x12d1 product=0x1436" | sudo tee /etc/modprobe.d/usbserial, RUN+=

В любом случае, если не известен этот код, всегда можно посмотреть эту последовательность для похожего (близкого) модема в файле /etc/usb_modeswitch.setup, а потом уточнить методом проб и ошибок или, для тех кто знаком, применить сниффер.
Сразу же привожу полный формат команды для ручного переключения режимов (практически срабатывает всегда)

sudo usb_modeswitch -v D_VID -p D_PID -V T_VID -P T_PID -M MC

где
D_VID, D_PID - Default VID&PID (берем из lsusb)
T_VID, T_PID - Target VID&PID (берем из /usr/share/usb_modeswitch/D_VID:D_PID
MC - MessageContent, последовательность из 31 байта - код для переключения (берем из /etc/usb_modeswitch.setup), если нет информации, действуем, как описал выше.


sudo usb_modeswitch -v 0x12d1 -p 0x1f01 -V 0x12d1 -P 0x14dc -M 55534243000000000000000000000011000000000000000000000000000000
lsusb
Bus 001 Device 019: ID 12d1:1442 Huawei Technologies Co., Ltd. HUAWEI_MOBILE

появился /dev/ttyUSB0

в отдельном терминале cat /dev/ttyUSB0

и видим AT команды

echo ATI > /dev/ttyUSB0

https://onedev.net/post/916  -  также правила переключения

echo AT^SFM=1 > /dev/ttyUSB0   (Factory Mode)

теперь после перезагрузки 
Bus 001 Device 022: ID 12d1:1c05 Huawei Technologies Co., Ltd. Broadband stick (modem on)

и имеем !!
/dev/ttyUSB0  /dev/ttyUSB1  /dev/ttyUSB2

команды и ответы в /dev/ttyUSB2

AT^SFM=1  Factory Mode
AT^FHVER  Узнать модель вашего модема: 
AT^VERSION?   Узнать версию прошивки: 
ATI - вывод информации о модеме
AT+CFUN=1 – перезагрузка модема
AT+CGMI - информация о производителе модема (Recieve: huawei)
AT+CGMR - информация о версии прошивки (Recieve: 11.608.12.04.21)
AT+CIMI - информация об IMSI номер SIM карты (Recieve: 250015800471114)
AT+CGSN - информация о IMEI модема (Recieve: 353142033840706)
AT^HWVER - информация о версии железа модема (Recieve: ^HWVER:"CD6ATCPU")
AT+CSQ - посмотреть уровень радиосигнала
AT^CMDL - получить список всех комманд
AT+CGMM или AT+GMM - запросить название модели
AT+COPS - информация о текущем операторе (Recieve: +COPS: (1,"MTS-RUS","MTS","25001",0),(2,"MTS-RUS","MTS","25001",2),,(0,1,2,3,4),(0,1,2))
AT^FHVER - показывает информацию о версии прошивки и версии железа (^FHVER:"E3276s-210 21.260.05.00.143,CH2E3276SM Ver.B")
AT^U2DIAG? - текущий режим.
AT^GETPORTMODE – список всех устройств в модеме
AT^VERSION? - информация о версии прошивки модема
AT+CLAC в ответе будет список поддерживаемых команд

и т д  https://3ginfo.ru/page53.html

AT^GETPORTMODE
- Показывает режим модема, который активен в данный момент.
AT^CARDLOCK?
модем выдаст такой ответ, например
AT^CARDLOCK?
^CARDLOCK: 2,10,0
Первая цифра ->  2 - означает, что SIM Lock снят или его нет, 1 - означает что модем залочен.
Вторая цифра ->  количество оставшихся попыток кода разблокировки. По умолчанию у нового модема их 10

echo AT^GODLOAD > /dev/ttyUSB2  - перезагрузка 

после перезагрузки виден только USB0

./balong_flash64 E3372h-153_Update_21.333.01.00.00_M_U_01.10.bin   -  модем прошился


 Программа для прошивки устройств на Balong-чипсете, V3.0.284, (c) forth32, 2015, GNU GPLv3
--------------------------------------------------------------------------------------------------
 Код файла прошивки: 9 (ONLY_FW)
                                 
 Цифровая подпись: 2958 байт
 Хеш открытого ключа: 778A8D175E602B7B779D9E05C330B5279B0661BF2EED99A20445B366D63DD697
 Версия прошивки: 21.333.01.00.00
 Платформа:       BV7R11HS__1
 Дата сборки:     2018.11.13 03:52:30
 Заголовок: версия 1, код соответствия: HWEW11.1
 Режим цифровой подписи: ONLY_FW (2958 байт)
 Версия протокола: 7200B--SKCBADZM
 Идентификатор устройства: HUAWEI BV7R11HS
----------------------------------------------------

##  ---- Имя раздела ---- записано
00  Fastboot              100%
01  M3Boot_R11            100%
02  M3Boot-ptable         100%
03  Kernel_R11            100%
04  VxWorks_R11           100%
05  M3Image_R11           100%
06  DSP_R11               100%
07  Nvdload_R11           100%
08  System                100%
09  APP                   100%

 Перезагрузка модема...





после прошивки (запрет на переключение стоит)
Bus 001 Device 070: ID 12d1:14fe Huawei Technologies Co., Ltd. Modem (Mass Storage Mode)

sudo usb_modeswitch -v 0x12d1 -p 0x14fe -V 0x12d1 -P 0x14dc -M 55534243000000000000000000000011000000000000000000000000000000
Look for target devices ...
 No devices in target mode or class found
Look for default devices ...
 Found devices in default mode (1)
Access device 070 on bus 001
Get the current device configuration ...
Current configuration number is 1
Use interface number 0
 with class 8
Use endpoints 0x01 (out) and 0x81 (in)
Looking for active drivers ...
 OK, driver detached
Set up interface 0
Use endpoint 0x01 for message sending ...
Trying to send message 1 to endpoint 0x01 ...
 OK, message successfully sent
Read the response to message 1 (CSW) ...
 Device seems to have vanished after reading. Good.
 Device is gone, skip any further commands
-> Run lsusb to note any changes. Bye!

Bus 001 Device 071: ID 12d1:1506 Huawei Technologies Co., Ltd. Modem/Networkcard
2 порта
/dev/ttyUSB0  /dev/ttyUSB1
Команды по 1 порту
sudo echo AT^GODLOAD > /dev/ttyUSB1
Bus 001 Device 072: ID 12d1:1c05 Huawei Technologies Co., Ltd. Broadband stick (modem on)
Можно прошивать заново

./balong_flash64 E3372h-153_Update_21.200.07.00.209_01.10.bin -p /dev/ttyUSB1
 так шьется прошивка которая начинается на 21


 После иголки
 /dev/ttyUSB0
 Bus 001 Device 119: ID 12d1:1443 Huawei Technologies Co., Ltd. USB COM

./balong-usbdload usblsafe-3372h.bin
модем прошивается и становится 
Bus 001 Device 120: ID 12d1:1c05 Huawei Technologies Co., Ltd. Broadband stick (modem on)
/dev/ttyUSB0  /dev/ttyUSB1  /dev/ttyUSB2
sudo echo AT^GODLOAD > /dev/ttyUSB2

./balong_flash64 E3372h-153_Update_22.200.15.00.00_M_AT_05.10.bin -p /dev/ttyUSB2

Модем прошит 22 прошивкой

Bus 001 Device 124: ID 12d1:1442 Huawei Technologies Co., Ltd. Vodafone (Huawei)
после перезагрузки
Bus 001 Device 125: ID 12d1:1f01 Huawei Technologies Co., Ltd. E353/E3131 (Mass storage mode)

Разрешаем переключение sudo nano /etc/usb_modeswitch.conf 
DisableSwitching=0
и после перезагрузки имеем

Bus 001 Device 004: ID 12d1:14dc Huawei Technologies Co., Ltd. E33372 LTE/UMTS/GSM HiLink Modem/Networkcard

и появляется connection



Переключение композиции
AT команд переключения не предусмотрено.
Автоматически переключиться можно в некоторых прошивках через WebUI. Либо с помощью usb_modeswitch (работает из коробки).

usb_modeswitch -v12d1 -p 1f01 -M "5553424312345678000000000000001106хх00000101000100000000000000"
Здесь xx и определяет тип сетевого адаптера:
00 - rndis
10 или 20 - cdc
30 - режим gateway (эмуляция стик-модема)

Переключение в режим сетевой карты 12d1:1f01 > 12d1:14dc
usb_modeswitch -v12d1 -p 1f01 -M "55534243123456780000000000000011060000000101000100000000000000"
Переключение в режим с COM портами 12d1:1f01 > 12d1:1001
usb_modeswitch -v12d1 -p 1f01 -M "55534243123456780000000000000011063000000101000100000000000000"


sudo usb_modeswitch -v 0x12d1 -p 0x14dc -V 0x12d1 -P 0x1f01 -M "55534243123456780000000000000011063000000101000100000000000000"

sudo usb_modeswitch -v 0x12d1 -p 0x14dc -V 0x12d1 -P 0x14dc -M 55534243000000000000000000000011000000000000000000000000000000

webui шьется сразу после прошивки до перезагрузки